---
/**
 * LoveNote - Mid-article CTA component
 * A personal message from Richard & Misia encouraging readers to try the app
 */

interface Props {
  nativeLang?: string;
  targetLang?: string;
  articleSlug?: string;
}

const { nativeLang = 'en', targetLang = '', articleSlug = '' } = Astro.props;

// Translations for all supported languages
const LOVENOTE_TRANSLATIONS: Record<string, { title: string; body: string; button: string }> = {
  en: {
    title: "Learning for your partner?",
    body: "We're Richard & Misia â€” a couple who built this app because we wanted to learn each other's languages. If you're here for the same reason, we made something for you.",
    button: "Start learning together â†’"
  },
  es: {
    title: "Â¿Aprendiendo para tu pareja?",
    body: "Somos Richard y Misia â€” una pareja que creÃ³ esta app porque querÃ­amos aprender los idiomas del otro. Si estÃ¡s aquÃ­ por la misma razÃ³n, hicimos algo para ti.",
    button: "Empezar a aprender juntos â†’"
  },
  fr: {
    title: "Vous apprenez pour votre partenaire ?",
    body: "Nous sommes Richard & Misia â€” un couple qui a crÃ©Ã© cette app parce que nous voulions apprendre les langues de l'autre. Si vous Ãªtes ici pour la mÃªme raison, nous avons crÃ©Ã© quelque chose pour vous.",
    button: "Commencer Ã  apprendre ensemble â†’"
  },
  de: {
    title: "Lernst du fÃ¼r deine/n Partner/in?",
    body: "Wir sind Richard & Misia â€” ein Paar, das diese App entwickelt hat, weil wir die Sprachen des anderen lernen wollten. Wenn du aus dem gleichen Grund hier bist, haben wir etwas fÃ¼r dich.",
    button: "Gemeinsam lernen â†’"
  },
  it: {
    title: "Stai imparando per il tuo partner?",
    body: "Siamo Richard e Misia â€” una coppia che ha creato questa app perchÃ© volevamo imparare le lingue dell'altro. Se sei qui per lo stesso motivo, abbiamo creato qualcosa per te.",
    button: "Inizia a imparare insieme â†’"
  },
  pt: {
    title: "Aprendendo para o seu amor?",
    body: "Somos Richard e Misia â€” um casal que criou este app porque querÃ­amos aprender as lÃ­nguas um do outro. Se vocÃª estÃ¡ aqui pelo mesmo motivo, fizemos algo para vocÃª.",
    button: "ComeÃ§ar a aprender juntos â†’"
  },
  pl: {
    title: "Uczysz siÄ™ dla swojej drugiej poÅ‚Ã³wki?",
    body: "JesteÅ›my Richard i Misia â€” para, ktÃ³ra stworzyÅ‚a tÄ™ aplikacjÄ™, bo chcieliÅ›my nauczyÄ‡ siÄ™ jÄ™zykÃ³w drugiej osoby. JeÅ›li jesteÅ› tu z tego samego powodu, stworzyliÅ›my coÅ› dla ciebie.",
    button: "Zacznij uczyÄ‡ siÄ™ razem â†’"
  },
  ru: {
    title: "Ğ£Ñ‡Ğ¸Ñ‚Ğµ ÑĞ·Ñ‹Ğº Ğ´Ğ»Ñ Ğ»ÑĞ±Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ°?",
    body: "ĞœÑ‹ â€” Ğ Ğ¸Ñ‡Ğ°Ñ€Ğ´ Ğ¸ ĞœĞ¸ÑÑ, Ğ¿Ğ°Ñ€Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ»Ğ° ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ, Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼Ñƒ Ñ‡Ñ‚Ğ¾ Ñ…Ğ¾Ñ‚ĞµĞ»Ğ¸ Ğ²Ñ‹ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ·Ñ‹ĞºĞ¸ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ°. Ğ•ÑĞ»Ğ¸ Ğ²Ñ‹ Ğ·Ğ´ĞµÑÑŒ Ğ¿Ğ¾ Ñ‚Ğ¾Ğ¹ Ğ¶Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ğµ, Ğ¼Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ»Ğ¸ ĞºĞ¾Ğµ-Ñ‡Ñ‚Ğ¾ Ğ´Ğ»Ñ Ğ²Ğ°Ñ.",
    button: "ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ ÑƒÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ²Ğ¼ĞµÑÑ‚Ğµ â†’"
  },
  nl: {
    title: "Leer je voor je partner?",
    body: "Wij zijn Richard & Misia â€” een stel dat deze app heeft gemaakt omdat we elkaars talen wilden leren. Als je hier bent om dezelfde reden, hebben we iets voor je gemaakt.",
    button: "Begin samen te leren â†’"
  },
  uk: {
    title: "Ğ’Ğ¸Ğ²Ñ‡Ğ°Ñ”Ñ‚Ğµ Ğ¼Ğ¾Ğ²Ñƒ Ğ´Ğ»Ñ ĞºĞ¾Ñ…Ğ°Ğ½Ğ¾Ñ— Ğ»ÑĞ´Ğ¸Ğ½Ğ¸?",
    body: "ĞœĞ¸ â€” Ğ Ñ–Ñ‡Ğ°Ñ€Ğ´ Ñ– ĞœÑ–ÑÑ, Ğ¿Ğ°Ñ€Ğ°, ÑĞºĞ° ÑÑ‚Ğ²Ğ¾Ñ€Ğ¸Ğ»Ğ° Ñ†ĞµĞ¹ Ğ´Ğ¾Ğ´Ğ°Ñ‚Ğ¾Ğº, Ğ±Ğ¾ Ñ…Ğ¾Ñ‚Ñ–Ğ»Ğ¸ Ğ²Ğ¸Ğ²Ñ‡Ğ¸Ñ‚Ğ¸ Ğ¼Ğ¾Ğ²Ğ¸ Ğ¾Ğ´Ğ½Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾. Ğ¯ĞºÑ‰Ğ¾ Ğ²Ğ¸ Ñ‚ÑƒÑ‚ Ğ· Ñ‚Ñ–Ñ”Ñ— Ğ¶ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ğ¸, Ğ¼Ğ¸ ÑÑ‚Ğ²Ğ¾Ñ€Ğ¸Ğ»Ğ¸ Ñ‰Ğ¾ÑÑŒ Ğ´Ğ»Ñ Ğ²Ğ°Ñ.",
    button: "ĞŸĞ¾Ñ‡Ğ°Ñ‚Ğ¸ Ğ²Ñ‡Ğ¸Ñ‚Ğ¸ÑÑ Ñ€Ğ°Ğ·Ğ¾Ğ¼ â†’"
  },
  sv: {
    title: "LÃ¤r du dig fÃ¶r din partner?",
    body: "Vi Ã¤r Richard & Misia â€” ett par som skapade denna app fÃ¶r att vi ville lÃ¤ra oss varandras sprÃ¥k. Om du Ã¤r hÃ¤r av samma anledning har vi skapat nÃ¥got fÃ¶r dig.",
    button: "BÃ¶rja lÃ¤ra er tillsammans â†’"
  },
  no: {
    title: "LÃ¦rer du for partneren din?",
    body: "Vi er Richard & Misia â€” et par som laget denne appen fordi vi ville lÃ¦re hverandres sprÃ¥k. Hvis du er her av samme grunn, har vi laget noe for deg.",
    button: "Begynn Ã¥ lÃ¦re sammen â†’"
  },
  da: {
    title: "LÃ¦rer du for din partner?",
    body: "Vi er Richard & Misia â€” et par der lavede denne app, fordi vi ville lÃ¦re hinandens sprog. Hvis du er her af samme grund, har vi lavet noget til dig.",
    button: "Begynd at lÃ¦re sammen â†’"
  },
  cs: {
    title: "UÄÃ­te se pro svÃ©ho partnera?",
    body: "Jsme Richard a Misia â€” pÃ¡r, kterÃ½ vytvoÅ™il tuto aplikaci, protoÅ¾e jsme se chtÄ›li nauÄit jazyky toho druhÃ©ho. Pokud jste tu ze stejnÃ©ho dÅ¯vodu, vytvoÅ™ili jsme nÄ›co pro vÃ¡s.",
    button: "ZaÄnÄ›te se uÄit spoleÄnÄ› â†’"
  },
  el: {
    title: "ÎœÎ±Î¸Î±Î¯Î½ÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î¿Î½/Ï„Î·Î½ ÏƒÏÎ½Ï„ÏÎ¿Ï†ÏŒ ÏƒÎ¿Ï…;",
    body: "Î•Î¯Î¼Î±ÏƒÏ„Îµ Î¿ Richard ÎºÎ±Î¹ Î· Misia â€” Î­Î½Î± Î¶ÎµÏ…Î³Î¬ÏÎ¹ Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÏ€ÎµÎ¹Î´Î® Î¸Î­Î»Î±Î¼Îµ Î½Î± Î¼Î¬Î¸Î¿Ï…Î¼Îµ Ï„Î¹Ï‚ Î³Î»ÏÏƒÏƒÎµÏ‚ Ï„Î¿Ï… Î¬Î»Î»Î¿Ï…. Î‘Î½ ÎµÎ¯ÏƒÎ±Î¹ ÎµÎ´Ï Î³Î¹Î± Ï„Î¿Î½ Î¯Î´Î¹Î¿ Î»ÏŒÎ³Î¿, Ï†Ï„Î¹Î¬Î¾Î±Î¼Îµ ÎºÎ¬Ï„Î¹ Î³Î¹Î± ÏƒÎ­Î½Î±.",
    button: "ÎÎµÎºÎ¹Î½Î®ÏƒÏ„Îµ Î½Î± Î¼Î±Î¸Î±Î¯Î½ÎµÏ„Îµ Î¼Î±Î¶Î¯ â†’"
  },
  hu: {
    title: "A parod kedvÃ©Ã©rt tanulsz?",
    body: "Mi Richard Ã©s Misia vagyunk â€” egy pÃ¡r, aki azÃ©rt hozta lÃ©tre ezt az alkalmazÃ¡st, mert meg akartuk tanulni egymÃ¡s nyelvÃ©t. Ha te is ezÃ©rt vagy itt, kÃ©szÃ­tettÃ¼nk valamit neked.",
    button: "Kezdj el egyÃ¼tt tanulni â†’"
  },
  tr: {
    title: "Partneriniz iÃ§in mi Ã¶ÄŸreniyorsunuz?",
    body: "Biz Richard ve Misia'yÄ±z â€” birbirimizin dillerini Ã¶ÄŸrenmek istediÄŸimiz iÃ§in bu uygulamayÄ± oluÅŸturan bir Ã§iftiz. AynÄ± nedenle buradaysanÄ±z, sizin iÃ§in bir ÅŸey yaptÄ±k.",
    button: "Birlikte Ã¶ÄŸrenmeye baÅŸla â†’"
  },
  ro: {
    title: "ÃnveÈ›i pentru partenerul tÄƒu?",
    body: "Suntem Richard È™i Misia â€” un cuplu care a creat aceastÄƒ aplicaÈ›ie pentru cÄƒ am vrut sÄƒ Ã®nvÄƒÈ›Äƒm limbile celuilalt. DacÄƒ eÈ™ti aici din acelaÈ™i motiv, am creat ceva pentru tine.",
    button: "Ãncepe sÄƒ Ã®nveÈ›i Ã®mpreunÄƒ â†’"
  },
};

const t = LOVENOTE_TRANSLATIONS[nativeLang] || LOVENOTE_TRANSLATIONS.en;

// Build UTM-tagged URL for attribution
const utmParams = new URLSearchParams({
  utm_source: 'blog',
  utm_medium: 'lovenote',
  utm_campaign: `${nativeLang}-${targetLang}`,
  utm_content: articleSlug,
});
const ctaUrl = `/?${utmParams.toString()}`;
---

<aside class="love-note my-10 p-6 bg-gradient-to-r from-pink-50 to-rose-50 rounded-2xl border border-pink-100 relative overflow-hidden">
  <!-- Decorative heart -->
  <div class="absolute -top-2 -right-2 text-4xl opacity-20 rotate-12">ğŸ’˜</div>

  <div class="relative z-10">
    <p class="text-rose-500 font-bold text-sm mb-2 flex items-center gap-2">
      <span>ğŸ’˜</span> {t.title}
    </p>

    <p class="text-gray-700 mb-4 leading-relaxed">
      {t.body}
    </p>

    <a
      href={ctaUrl}
      class="inline-flex items-center gap-2 px-5 py-2.5 bg-rose-500 font-bold rounded-full hover:bg-rose-600 hover:shadow-lg hover:scale-105 transition-all text-sm love-note-cta" style="color: white !important;"
      data-native={nativeLang}
      data-target={targetLang}
      data-article={articleSlug}
    >
      {t.button}
    </a>
  </div>
</aside>

<script>
  // Track Love Note CTA clicks
  document.querySelectorAll('.love-note-cta').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const target = e.currentTarget as HTMLElement;
      if (typeof gtag !== 'undefined') {
        gtag('event', 'love_note_click', {
          native_lang: target.dataset.native,
          target_lang: target.dataset.target,
          article_slug: target.dataset.article,
          page_path: window.location.pathname,
          event_category: 'conversion',
        });
      }
    });
  });
</script>
